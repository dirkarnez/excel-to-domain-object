<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <!-- <script>
        (() => {
            //fetch("./examples/ohms-law.xlsx")
            
        })();
    </script> -->

    <script type="module">
        import { default as ExcelJS } from "./exceljs.1.8.0.esm.min.js";
        import { default as CodeGenerator } from "./code-generator.js";
        const workbook = new ExcelJS.Workbook();
        
        try {
            const excelFile = await workbook.xlsx.load(
                await (
                    await fetch ("./examples/ohms-law.xlsx")
                )
                .arrayBuffer()
            );

            const worksheet = excelFile.getWorksheet('Sheet1');
            const lineHeader = 1;
            const lineToLearn = 2;

            // Array(worksheet.getRow(lineToLearn).actualCellCount)
            // .fill(NaN)
            // .map((_, index) => {
            //     worksheet.getRow(lineToLearn).getCell(1).value
            // })

            // if has formula, they are readonly, else setter
            let rowDataForHyperformula = [];
            worksheet.getRow(lineToLearn).eachCell((cell) => {
                const cellData = cell.value.formula ? `=${cell.value.formula}` : cell.value;
                rowDataForHyperformula.push(cellData);
            });

            let fields = [];
            worksheet
            .getRow(lineHeader)
            .eachCell((headerCurrentCell, i) => {
                const cell = worksheet.getRow(lineToLearn).getCell(i);
                // cell.value.formula ? `=${cell.value.formula}` : cell.value;
                const field = {
                    name: headerCurrentCell.value,
                    commentForName: cell.address,
                    readonly: !!cell.value.formula,
                    formula: cell.value.formula
                };
                fields.push(field);
            });


            console.log(CodeGenerator(fields));

            // worksheet.getCell("A2").formulaType === Excel.Enums.FormulaType.Master;
            // console.log(worksheet.getCell("A2").formulaType === ExcelJS.FormulaType.Master);
        } catch (e) {
            debugger;
        }

        debugger;
    </script>
</body>
</html>